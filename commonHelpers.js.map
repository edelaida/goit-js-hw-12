{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport axios from \"axios\";\n\nconst formImg = document.querySelector('.form');\nconst pictures = document.querySelector('.gallery');\nconst btnLoadMore = document.querySelector('.js-btn-load')\nconst loadElem = document.querySelector('.js-loader');\n\nconst modal = new SimpleLightbox('.gallery a', {\n  captionsData: \"alt\",\n  captions: true,\n  captionDelay: 250,\n  captionsPosition: 'bottom',\n});\n\nlet page = 1;\nlet limit = 40;\nlet totalResults = 0;\nlet maxPage = 0;\nlet serchValue = '';\n\nasync function fetchUsers(q) {\n  const API_KEY = '42086416-f15f3f0137ece30b1354f2d54';\n  const PARAMS = new URLSearchParams({\n    key: API_KEY,\n    q,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: page,\n      per_page: limit,\n  });\n  const BASE_URL = 'https://pixabay.com/api';\n  const url = `${BASE_URL}/?${PARAMS}`; \n  const response = await axios.get(url, PARAMS);  \n   totalResults = response.data.totalHits;        \n    return response.data.hits;   \n }\n \nformImg.addEventListener('submit', handleSubmit);\nbtnLoadMore.addEventListener('click', onLoadMore);\n\nasync function handleSubmit(ent) {\n    ent.preventDefault();   \n    pictures.innerHTML = '';    \n      page = 1;\n  serchValue = '';\n  try {\n    serchValue = ent.currentTarget.elements.title.value.trim();\n    \n    if (!serchValue) {\n      return iziToast.show({\n        message: `Please enter name to search`,\n        position: 'topRight',\n        backgroundColor: 'red',\n        messageColor: 'white',\n      });      \n    }\n      \n    const arr = await fetchUsers(serchValue)\n      \n    if (arr.length === 0) {\n     iziToast.error({\n            position: 'center',\n            title: 'Error',\n            message: 'Sorry, there are no images matching your search query. Please try again!',\n     })\n      btnLoadMore.classList.add('is-hidden');\n    } else {\n      pictures.innerHTML = markUp(arr);\n      btnLoadMore.classList.remove('is-hidden');\n   }        \n        modal.refresh();\n        hideLoader();\n    changeBtnStatus(arr);\n    ent.target.reset();\n       \n    } catch(error) {\n        iziToast.error({\n            position: 'center',\n            title: 'Error',\n            message: 'Sorry, there are no images matching your search query. Please try again!',\n        })\n    }      \n}\n\nasync function onLoadMore() {\n  page += 1;\n  showLoader();\n  const arr = await fetchUsers(serchValue)\n  pictures.insertAdjacentHTML('beforeend', markUp(arr));\n  modal.refresh();\n    hideLoader();\n  changeBtnStatus();\n}\n\nfunction changeBtnStatus() {\n  maxPage = Math.ceil(totalResults / limit);\n  if (page >= maxPage) {\n    btnLoadMore.classList.add('is-hidden');\n    iziToast.error({\n            position: 'bottomLeft',\n            title: 'We are sorry',\n            message: 'but you ve reached the end of search results.',\n        })\n  } else {\n    btnLoadMore.classList.remove('is-hidden');\n  }\n}\n\nfunction showLoader() {\n  loadElem.classList.remove('is-hidden');\n}\nfunction hideLoader() {\n  loadElem.classList.add('is-hidden');\n}\n\nfunction markUp(arr) {\n  return arr.map(({webformatURL, largeImageURL, tags, likes, comments, downloads}) => {\n    return `\n <li class=\"gallery-item\">\n  <a class=\"gallery-link\" href=\"${largeImageURL}\">\n    <img class=\"gallery-image\" src=\"${webformatURL}\" \n    alt=\"${tags}\"/></a>\n    <ul class=\"gallery-info\">\n          <li class=\"info-item\">\n            <h4 class=\"info-title\">likes</h4>\n            <p class=\"info-rez\">${likes}</p> \n          </li>\n          <li class=\"info-item\">\n            <h4 class=\"info-title\">comments</h4>\n            <p class=\"info-rez\">${comments}</p> \n           </li>\n          <li class=\"info-item\">\n            <h4 class=\"info-title\">downloads</h4>\n            <p class=\"info-rez\">${downloads}</p> \n           </li>\n        </ul> \n  </li>`\n})\n .join(\"\"); \n}\n\n"],"names":["formImg","pictures","btnLoadMore","loadElem","modal","SimpleLightbox","page","limit","totalResults","maxPage","serchValue","fetchUsers","q","API_KEY","PARAMS","url","response","axios","handleSubmit","onLoadMore","ent","iziToast","arr","markUp","hideLoader","changeBtnStatus","showLoader","webformatURL","largeImageURL","tags","likes","comments","downloads"],"mappings":"owBAMA,MAAMA,EAAU,SAAS,cAAc,OAAO,EACxCC,EAAW,SAAS,cAAc,UAAU,EAC5CC,EAAc,SAAS,cAAc,cAAc,EACnDC,EAAW,SAAS,cAAc,YAAY,EAE9CC,EAAQ,IAAIC,EAAe,aAAc,CAC7C,aAAc,MACd,SAAU,GACV,aAAc,IACd,iBAAkB,QACpB,CAAC,EAED,IAAIC,EAAO,EACPC,EAAQ,GACRC,EAAe,EACfC,EAAU,EACVC,EAAa,GAEjB,eAAeC,EAAWC,EAAG,CAC3B,MAAMC,EAAU,qCACVC,EAAS,IAAI,gBAAgB,CACjC,IAAKD,EACL,EAAAD,EACA,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAMN,EACJ,SAAUC,CAChB,CAAG,EAEKQ,EAAM,4BAAgBD,IACtBE,EAAW,MAAMC,EAAM,IAAIF,EAAKD,CAAM,EAC3C,OAAAN,EAAeQ,EAAS,KAAK,UACrBA,EAAS,KAAK,IACvB,CAEFhB,EAAQ,iBAAiB,SAAUkB,CAAY,EAC/ChB,EAAY,iBAAiB,QAASiB,CAAU,EAEhD,eAAeD,EAAaE,EAAK,CAC7BA,EAAI,eAAc,EAClBnB,EAAS,UAAY,GACnBK,EAAO,EACXI,EAAa,GACb,GAAI,CAGF,GAFAA,EAAaU,EAAI,cAAc,SAAS,MAAM,MAAM,OAEhD,CAACV,EACH,OAAOW,EAAS,KAAK,CACnB,QAAS,8BACT,SAAU,WACV,gBAAiB,MACjB,aAAc,OACtB,CAAO,EAGH,MAAMC,EAAM,MAAMX,EAAWD,CAAU,EAEnCY,EAAI,SAAW,GAClBD,EAAS,MAAM,CACR,SAAU,SACV,MAAO,QACP,QAAS,0EACrB,CAAM,EACAnB,EAAY,UAAU,IAAI,WAAW,IAErCD,EAAS,UAAYsB,EAAOD,CAAG,EAC/BpB,EAAY,UAAU,OAAO,WAAW,GAEtCE,EAAM,QAAO,EACboB,IACJC,EAAgBH,CAAG,EACnBF,EAAI,OAAO,OAEV,MAAC,CACEC,EAAS,MAAM,CACX,SAAU,SACV,MAAO,QACP,QAAS,0EACrB,CAAS,CACJ,CACL,CAEA,eAAeF,GAAa,CAC1Bb,GAAQ,EACRoB,IACA,MAAMJ,EAAM,MAAMX,EAAWD,CAAU,EACvCT,EAAS,mBAAmB,YAAasB,EAAOD,CAAG,CAAC,EACpDlB,EAAM,QAAO,EACXoB,IACFC,GACF,CAEA,SAASA,GAAkB,CACzBhB,EAAU,KAAK,KAAKD,EAAeD,CAAK,EACpCD,GAAQG,GACVP,EAAY,UAAU,IAAI,WAAW,EACrCmB,EAAS,MAAM,CACP,SAAU,aACV,MAAO,eACP,QAAS,+CACrB,CAAS,GAELnB,EAAY,UAAU,OAAO,WAAW,CAE5C,CAEA,SAASwB,GAAa,CACpBvB,EAAS,UAAU,OAAO,WAAW,CACvC,CACA,SAASqB,GAAa,CACpBrB,EAAS,UAAU,IAAI,WAAW,CACpC,CAEA,SAASoB,EAAOD,EAAK,CACnB,OAAOA,EAAI,IAAI,CAAC,CAAC,aAAAK,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAS,IACrE;AAAA;AAAA,kCAEuBJ;AAAA,sCACID;AAAA,WAC3BE;AAAA;AAAA;AAAA;AAAA,kCAIuBC;AAAA;AAAA;AAAA;AAAA,kCAIAC;AAAA;AAAA;AAAA;AAAA,kCAIAC;AAAA;AAAA;AAAA,QAIjC,EACC,KAAK,EAAE,CACT"}